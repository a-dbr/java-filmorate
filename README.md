# üéûÔ∏è Filmorate
## –û–ø–∏—Å–∞–Ω–∏–µ
–°–æ—Ü–∏–∞–ª—å–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –∫–∏–Ω–æ–º–∞–Ω–æ–≤. –£—á–µ–±–Ω—ã–π –ø—Ä–æ–µ–∫—Ç –ø–æ Spring Boot –∏ SQL.

## –°—Ç–∞—Ç—É—Å
–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ üõ†Ô∏è

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π ‚úÖ
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –¥—Ä—É–∑—å—è ‚úÖ
  - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –≤ –¥—Ä—É–∑—å—è ‚úÖ
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –æ–±—â–∏—Ö –¥—Ä—É–∑–µ–π ‚úÖ
  - –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –¥—Ä—É–∑–µ–π ‚úÖ
- –õ–∞–π–∫–∏ —Ñ–∏–ª—å–º–æ–≤ ‚úÖ
  - –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ø–∞ —Ñ–∏–ª—å–º–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –ª–∞–π–∫–æ–≤ ‚úÖ
- –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ —Ñ–∏–ª—å–º–æ–≤ –ø–æ MPA ‚úÖ
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–∫–∞–∑–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∂–∞–Ω—Ä–æ–≤ —Ñ–∏–ª—å–º–∞ ‚úÖ

## ER –¥–∏–∞–≥—Ä–∞–º–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
![base.png](docs/base.png)

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç 3-–π –Ω–æ—Ä–º–∞–ª—å–Ω–æ–π —Ñ–æ—Ä–º–µ.

## –û–ø–∏—Å–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

| –¢–∞–±–ª–∏—Ü–∞          | –û–ø–∏—Å–∞–Ω–∏–µ                                |
|------------------|-----------------------------------------|
| *users*          | –¢–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π         |
| *friends*        | –î—Ä—É–∂–±–∞ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.            |
| *likes*          | –õ–∞–π–∫–∏ —Ñ–∏–ª—å–º–æ–≤ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π          |
| *films*          | –¢–∞–±–ª–∏—Ü–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ —Ñ–∏–ª—å–º–æ–≤               |
| *genres*         | –¢–∞–±–ª–∏—Ü–∞ —Å –∂–∞–Ω—Ä–∞–º–∏ —Ñ–∏–ª—å–º–æ–≤               |
| *film_genres*    | –¢–∞–±–ª–∏—Ü–∞ —Å–≤—è–∑–∏ —Ñ–∏–ª—å–º–æ–≤ —Å –∂–∞–Ω—Ä–∞–º–∏         |
| *content_rating* | –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥ –ø–æ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ MPA |

## –ü—Ä–∏–º–µ—Ä—ã SQL –∑–∞–ø—Ä–æ—Å–æ–≤

–ü–æ–∏—Å–∫ –æ–±—â–∏—Ö –¥—Ä—É–∑–µ–π
```sql
SELECT u.*
FROM users u
-- –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ—Ö –¥—Ä—É–∑–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å ID = 1
       JOIN friends f1
            ON (
              (f1.user1_id = 1 AND u.id = f1.user2_id)  -- –µ—Å–ª–∏ 1 –≤ –ø–µ—Ä–≤–æ–π –∫–æ–ª–æ–Ω–∫–µ, –±–µ—Ä—ë–º –≤—Ç–æ—Ä–æ–≥–æ
                OR (f1.user2_id = 1 AND u.id = f1.user1_id)  -- –µ—Å–ª–∏ 1 –≤–æ –≤—Ç–æ—Ä–æ–π –∫–æ–ª–æ–Ω–∫–µ, –±–µ—Ä—ë–º –ø–µ—Ä–≤–æ–≥–æ
              )
-- –ù–∞—Ö–æ–¥–∏–º –≤—Å–µ—Ö –¥—Ä—É–∑–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å ID = 2
       JOIN friends f2
            ON (
              (f2.user1_id = 2 AND u.id = f2.user2_id)  -- –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è 2
                OR (f2.user2_id = 2 AND u.id = f2.user1_id)
              );
```
–¢–æ–ø 100 —Ñ–∏–ª—å–º–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ –æ—Ü–µ–Ω–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```sql
SELECT f.*
        FROM films f
        LEFT JOIN likes l ON f.id = l.film_id
        GROUP BY f.id
        ORDER BY COUNT(l.user_id) DESC
        LIMIT 100
```